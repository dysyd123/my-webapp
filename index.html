<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ì œê³¼ì œë¹µ íƒ€ì´ë¨¸</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        text-align: center;
        padding: 20px;
      }
      h1 {
        font-size: 3em;
      }
      h2 {
        margin-top: 80px;
      }
      .time-container {
        display: grid;
        grid-template-columns: 1fr; /* í•œ ì¤„ì”© ë‚˜ì˜¤ë„ë¡ ì„¤ì •. 4ì»·ìœ¼ë¡œ í•˜ë ¤ë©´ "1fr 1.5fr"ë¡œ ë³€ê²½í•˜ê³  div ìˆœì„œ ë³€ê²½*/
        gap: 20px;
        justify-content: center;
        align-items: center;
        max-width: 400px; /* ê°€ë¡œ í­ ì¡°ì ˆ, 4ì»·ìœ¼ë¡œ í•˜ë ¤ë©´ 600ìœ¼ë¡œ ì¡°ì • */
        margin: auto;
      }
      .time-box {
        font-size: 2em;
        padding: 20px;
        border: 3px solid black;
        border-radius: 15px;
        background-color: #f8f8f8;
      }
      .time-box2 {
        font-size: 2em;
        padding: 20px;
        margin-bottom: 5px;
        border: 3px solid black;
        border-radius: 15px;
        background-color: #f8f8f8;
        min-height: 6em;
        display: flex;
        flex-direction: column; /* ìš”ì†Œë¥¼ ìœ„ì—ì„œ ì•„ë˜ë¡œ ë°°ì¹˜ */
        justify-content: center; /* ì„¸ë¡œ ì¤‘ì•™ ì •ë ¬ */
        align-items: center; /* ê°€ë¡œ ì¤‘ì•™ ì •ë ¬ */
        text-align: center; /* í…ìŠ¤íŠ¸ ì •ë ¬ */
      }
      .small-text {
        font-size: 0.5em;
        margin-left: 5px;
      }
      .big-text {
        font-size: 1.5em;
        margin-left: 5px;
      }
      #remaining-time {
        font-size: 2em;
        font-weight: bold;
        color: red;
        width: 100%;
        white-space: nowrap;
      }

      .preset-box {
        display: grid;
        grid-template-columns: repeat(5, 1fr); /* í•œ ì¤„ì— 5ê°œ */
        gap: 10px; /* ë²„íŠ¼ ê°„ê²© */
        justify-content: center;
        white-space: pre-line;
      }
      .control-box {
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        margin-top: 20px;
      }
      .preset-box button,
      .control-box button {
        font-size: 1.2em;
        padding: 10px 15px;
        margin: 5px;
      }
    </style>
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#8B4513">
    <script>
     if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('service-worker.js');
      }
    </script>
  </head>
  <body>
    <audio id="beep-sound" src="End-bell.mp3"></audio>
    <audio id="1m" src="1minute.mp3"></audio>
    <audio id="10m" src="10minutes.mp3"></audio>
    <audio id="30m" src="30minutes.mp3"></audio>
    <audio id="1h" src="1hour.mp3"></audio>
    <h1 id="title">ì œê³¼ì œë¹µ íƒ€ì´ë¨¸</h1>
    <div class="time-container">
      <div class="time-box">
        í˜„ì¬ ì‹œê°„<br /><span id="current-time">00:00</span>
      </div>
      <div class="time-box">
        ì‹œì‘ ì‹œê°„<br /><span id="start-time">--:-- </span>
      </div>
      <div class="time-box">
        ì¢…ë£Œ ì‹œê°„<br /><span id="end-time">--:-- </span>
      </div>
      <div class="time-box2">
        ë‚¨ì€ ì‹œê°„<br /><span id="remaining-time">-- </span>
      </div>
    </div>
    <h2>ê³¼ì œ ì„ íƒ</h2>
    <div id="preset-container" class="preset-box"></div>
    <div class="control-box">
      <button id="weigh-button" disabled>ê³„ëŸ‰ ì‹œì‘</button>
      <button id="start-button" disabled>ë³¸ì‹œí—˜ ì‹œì‘</button>
      <button id="reset-button">ì´ˆê¸°í™”</button>
    </div>
    <script>
      const presets = {
        ì œê³¼1_ì´ˆì½”ë¨¸í•€: { setT: 110, setN: 'ì´ˆì½”ë¨¸í•€', setW: 11 },
        ì œê³¼2_ë²„í„°ìŠ¤í€ì§€ë³„ë¦½: {
          setT: 110,
          setN: 'ë²„í„°ìŠ¤í€ì§€ì¼€ì´í¬(ë³„ë¦½ë²•)',
          setW: 8,
        },
        ì œê³¼3_ì ¤ë¦¬ë¡¤: { setT: 90, setN: 'ì ¤ë¦¬ë¡¤ì¼€ì´í¬', setW: 8 },
        ì œê³¼4_ì†Œí”„íŠ¸ë¡¤: { setT: 110, setN: 'ì†Œí”„íŠ¸ë¡¤ì¼€ì´í¬', setW: 10 },
        ì œê³¼5_ë²„í„°ìŠ¤í€ì§€ê³µë¦½: {
          setT: 110,
          setN: 'ë²„í„°ìŠ¤í€ì§€ì¼€ì´í¬(ê³µë¦½ë²•)',
          setW: 6,
        },
        ì œê³¼6_ë§ˆë“œë ˆëŠ: { setT: 110, setN: 'ë§ˆë“œë ˆëŠ', setW: 7 },
        ì œê³¼7_ì‡¼íŠ¸ë¸Œë ˆë“œ: { setT: 120, setN: 'ì‡¼íŠ¸ë¸Œë ˆë“œì¿ í‚¤', setW: 9 },
        ì œê³¼8_ìŠˆ: { setT: 120, setN: 'ìŠˆ', setW: 5 },
        ì œê³¼9_ë¸Œë¼ìš°ë‹ˆ: { setT: 110, setN: 'ë¸Œë¼ìš°ë‹ˆ', setW: 9 },
        ì œê³¼10_ê³¼ì¼ì¼€ìµ: { setT: 150, setN: 'ê³¼ì¼ì¼€ì´í¬', setW: 13 },
        ì œê³¼11_íŒŒìš´ë“œì¼€ìµ: { setT: 150, setN: 'íŒŒìš´ë“œì¼€ì´í¬', setW: 9 },
        ì œê³¼12_ë‹¤ì¿ ì™€ì¦ˆ: { setT: 110, setN: 'ë‹¤ì¿ ì™€ì¦ˆ', setW: 5 },
        ì œê³¼13_íƒ€ë¥´íŠ¸: { setT: 140, setN: 'íƒ€ë¥´íŠ¸', setW: 5 },
        ì œê³¼14_í‘ë¯¸ë¡¤: { setT: 110, setN: 'í‘ë¯¸ë¡¤ì¼€ì´í¬', setW: 7 },
        ì œê³¼15_ì‹œíì¼€ìµ: { setT: 100, setN: 'ì‹œíì¼€ì´í¬', setW: 8 },
        ì œê³¼16_ë§ˆë°ë¼ì»µ: { setT: 120, setN: 'ë§ˆë°ë¼ì»µì¼€ì´í¬', setW: 9 },
        ì œê³¼17_ë²„í„°ì¿ í‚¤: { setT: 120, setN: 'ë²„í„°ì¿ í‚¤', setW: 6 },
        ì œê³¼18_ì¹˜ì¦ˆì¼€ìµ: { setT: 150, setN: 'ì¹˜ì¦ˆì¼€ì´í¬', setW: 9 },
        ì œê³¼19_í˜¸ë‘íŒŒì´: { setT: 150, setN: 'í˜¸ë‘íŒŒì´', setW: 7 },
        ì œê³¼20_ì´ˆì½”ë¡¤: { setT: 110, setN: 'ì´ˆì½”ë¡¤', setW: 7 },
        í…ŒìŠ¤íŠ¸1: { setT: 70.2, setN: '60ë¶„í…ŒìŠ¤íŠ¸', setW: 10.1 },
        í…ŒìŠ¤íŠ¸2: { setT: 40.2, setN: '30ë¶„í…ŒìŠ¤íŠ¸', setW: 10.1 },
        í…ŒìŠ¤íŠ¸3: { setT: 20.2, setN: '10ë¶„í…ŒìŠ¤íŠ¸', setW: 10.1 },
        í…ŒìŠ¤íŠ¸4: { setT: 1.2, setN: 'ê³„ëŸ‰1ë¶„ ë° ì¢…ë£Œ í…ŒìŠ¤íŠ¸', setW: 1.1 },
      };

      let timerInterval;
      let selectedWeighm = null;
      let selectedMinutes = null;
      let selectedName = '';

      function updateCurrentTime() {
        const now = new Date();
        document.getElementById('current-time').innerHTML = formatTime(now);
      }

      function formatTime(date) {
        const hours = String(date.getHours()).padStart(2, '0');
        const minutes = String(date.getMinutes()).padStart(2, '0');
        return `${hours}:${minutes}`;
      }

      function setPreset(minutes, name, weighes) {
        selectedWeighm = weighes;
        selectedMinutes = minutes - weighes;
        selectedName = name;
        document.getElementById(
          'remaining-time'
        ).innerHTML = `ê³„ëŸ‰ ${weighes}<span class='small-text'>ë¶„</span> 00<span class='small-text'>ì´ˆ</span><br />ì‘ì—… ${
          minutes - weighes
        }<span class='small-text'>ë¶„</span> 00<span class='small-text'>ì´ˆ</span>`;
        document.getElementById('start-button').disabled = false;
        document.getElementById('weigh-button').disabled = false;
      }

      function startTimer() {
        if (selectedMinutes === null) return;

        clearInterval(timerInterval);
        let played10m = false;
        let played30m = false;
        let played1h = false;
        const now = new Date();
        const endTime = new Date(now.getTime() + selectedMinutes * 60000);
        document.getElementById('start-time').innerHTML = formatTime(now);
        document.getElementById('end-time').innerHTML = formatTime(endTime);
        document.getElementById('title').textContent = selectedName;

        timerInterval = setInterval(() => {
          const now = new Date();
          const diff = endTime - now;
          if (diff <= 3600000 && diff > 3595000 && !played1h) {
            const hourm = document.getElementById('1h');
            hourm.play();
            played1h = true;
          }
          if (diff <= 1800000 && diff > 1795000 && !played30m) {
            const thirtym = document.getElementById('30m');
            thirtym.play();
            played30m = true;
          }
          if (diff <= 600000 && diff > 595000 && !played10m) {
            const tenrm = document.getElementById('10m');
            tenrm.play();
            played10m = true;
          }
          if (diff <= 0) {
            clearInterval(timerInterval);
            document.getElementById('remaining-time').innerHTML = '00:00';
            const beep = document.getElementById('beep-sound');
            beep.play().then(() => {
              // ğŸ”¥ ì†Œë¦¬ê°€ ì¬ìƒëœ í›„ alert ì‹¤í–‰
              setTimeout(() => alert('íƒ€ì´ë¨¸ ì¢…ë£Œ!'), 100);
            });
          } else {
            const minutesLeft = String(Math.floor(diff / 60000));
            const secondsLeft = String(
              Math.floor((diff % 60000) / 1000)
            ).padStart(2, '0');
            document.getElementById(
              'remaining-time'
            ).innerHTML = `<span class='big-text'>${minutesLeft}</span><span class='small-text'>ë¶„</span> <span class='big-text'>${secondsLeft}</span><span class='small-text'>ì´ˆ</span> `;
          }
        }, 1000);
      }

      function weighTimer() {
        if (selectedWeighm === null) return;

        clearInterval(timerInterval);
        let played1m = false;
        const now = new Date();
        const endTime = new Date(now.getTime() + selectedWeighm * 60000);
        document.getElementById('start-time').innerHTML = formatTime(now);
        document.getElementById('end-time').innerHTML = formatTime(endTime);
        document.getElementById('title').textContent = selectedName;

        timerInterval = setInterval(() => {
          const now = new Date();
          const diff = endTime - now;
          if (diff <= 60000 && diff > 55000 && !played1m) {
            const onerm = document.getElementById('1m');
            onerm.play();
            played1m = true;
          }

          if (diff <= 0) {
            clearInterval(timerInterval);
            document.getElementById('remaining-time').innerHTML = '00:00';
            const beep = document.getElementById('beep-sound');
            beep.play().then(() => {
              // ğŸ”¥ ì†Œë¦¬ê°€ ì¬ìƒëœ í›„ alert ì‹¤í–‰
              setTimeout(() => alert('íƒ€ì´ë¨¸ ì¢…ë£Œ!'), 100);
            });
          } else {
            const minutesLeft = String(Math.floor(diff / 60000));
            const secondsLeft = String(
              Math.floor((diff % 60000) / 1000)
            ).padStart(2, '0');
            document.getElementById(
              'remaining-time'
            ).innerHTML = `<span class='big-text'>${minutesLeft}</span><span class='small-text'>ë¶„</span> <span class='big-text'>${secondsLeft}</span><span class='small-text'>ì´ˆ</span> `;
          }
        }, 1000);
      }

      function resetTimer() {
        clearInterval(timerInterval);
        selectedMinutes = null;
        selectedWeighm = null;
        document.getElementById('remaining-time').innerHTML = '--';
        document.getElementById('start-time').innerHTML = '--:--';
        document.getElementById('end-time').innerHTML = '--:--';
        document.getElementById('weigh-button').disabled = true;
        document.getElementById('start-button').disabled = true;
      }

      function createPresetButtons() {
        const container = document.getElementById('preset-container');
        Object.keys(presets).forEach((key) => {
          const btn = document.createElement('button');
          btn.textContent = `${key}`;
          btn.onclick = () =>
            setPreset(presets[key].setT, presets[key].setN, presets[key].setW);
          container.appendChild(btn);
        });
      }
      document.getElementById('weigh-button').onclick = weighTimer;
      document.getElementById('start-button').onclick = startTimer;
      document.getElementById('reset-button').onclick = resetTimer;
      createPresetButtons();
      setInterval(updateCurrentTime, 1000);
    </script>
  </body>
</html>
